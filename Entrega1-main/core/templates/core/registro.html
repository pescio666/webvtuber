{% extends 'core/base.html' %}
{% load static %}
{% load crispy_forms_tags %}

{% block head %}

{% endblock %}

{% block content %}
  <h1 class="tituloR">Nueva cuenta</h1>

  <section>
    <form action="" method="post" id="registro1">
      {% csrf_token %}
      {{ form.username }}
      {{ form.first_name }}
      {{ form.last_name }}
      {{ form.email }}
      {{ form.telefono }}
      {{ form.password1 }}
      {{ form.password2 }}

      <h5>DATOS DE ENV√çO</h5>

      {{ form.paises }}
      {{ form.provincia }}
      {{ form.direccion }}
      {{ form.dpto_casa }}
      {{ form.codigo_postal }}

      <button id="confirmar1" type="submit" class="btn btn-success">CREAR</button>
    </form>
  </section>

  <script src="https://code.jquery.com/jquery-3.6.0.min.js"></script>
  <script type="text/javascript">
    $(document).ready(function () {
      $('#id_pais').change(function () {
        var url = "{% url 'ajax_cargar_provincias' %}"
        var paisId = $(this).val()
    
        $.ajax({
          url: url,
          data: {
            pais_id: paisId
          },
          success: function (data) {
            $('#id_provincia').html('')
            for (var i = 0; i < data.provincias.length; i++) {
              var provincia = data.provincias[i]
              $('#id_provincia').append('<option value="' + provincia[0] + '">' + provincia[1] + '</option>')
            }
          }
        })
      })
    })
  </script>
{% endblock %}
